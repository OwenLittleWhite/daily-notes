# 2017-12-12

## run daily task script file in ubuntu

### create .sh file
```
#!/bin/bash
curl GET "https://localhost:3000" >/home/owen/
```

### add .sh file to be excuted
```
chmod +x increase.sh
```

### add tast
```
crontab -e

SHELL=/bin/bash
1 6 * * * cd ~/daily/ && ./increase.sh
```
# 2017-12-14

## mysql get top two trade_dates group by stock_code

```
    SELECT 
        `a`.`stock_code` AS `stock_code`,
        `a`.`end_date` AS `end_date`
    FROM
        `v_nch_date` `a`
    WHERE
        (2 >= (SELECT 
                COUNT(0)
            FROM
                `v_nch_date` `b`
            WHERE
                ((`a`.`stock_code` = `b`.`stock_code`)
                    AND (`a`.`end_date` <= `b`.`end_date`))))
    ORDER BY `a`.`stock_code` , `a`.`end_date` DESC
```
## from mysql2

mysql2/lib/commands/index.js

```
'client_handshake server_handshake query prepare close_statement execute ping register_slave binlog_dump change_user quit'
.split(' ')
.forEach(function(name) {
var ctor = require('./' + name + '.js');
module.exports[ctor.name] = ctor;
});
```

## mysql2 pool
one user only can use pool one by one
